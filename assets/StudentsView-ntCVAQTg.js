import{_ as O}from"./Breadcrumb-CLhXGeMR.js";import{m as C,i as t,c as r,b as s,u as R,r as x,o as T,n as L,a as M,f as U,F as k,d as w,e as d,h as W,g as X,p as q,q as v,t as u,s as y,l as G}from"./index-BkqMDDG8.js";const H={},J={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"};function K(g,i){return t(),r("svg",J,i[0]||(i[0]=[s("path",{fill:"currentColor",d:"M18.577 6.183a1 1 0 0 1 .24 1.394l-5.666 8.02c-.36.508-.665.94-.94 1.269c-.287.34-.61.658-1.038.86a2.83 2.83 0 0 1-2.03.153c-.456-.137-.82-.406-1.149-.702c-.315-.285-.672-.668-1.09-1.116l-1.635-1.753a1 1 0 1 1 1.462-1.364l1.606 1.722c.455.487.754.806.998 1.027c.24.216.344.259.385.271c.196.06.405.045.598-.046c.046-.022.149-.085.36-.338c.216-.257.473-.62.863-1.171l5.642-7.986a1 1 0 0 1 1.394-.24"},null,-1)]))}const _=C(H,[["render",K]]),P={},Q={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"};function Y(g,i){return t(),r("svg",Q,i[0]||(i[0]=[s("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M18 6L6 18M6 6l12 12"},null,-1)]))}const $=C(P,[["render",Y]]),Z={},ee={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"};function te(g,i){return t(),r("svg",ee,i[0]||(i[0]=[s("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m11 16l-3 3m0 0l-3-3m3 3V5m5 3l3-3m0 0l3 3m-3-3v14"},null,-1)]))}const se=C(Z,[["render",te]]),ae={class:"mt-5"},ne=["dir"],re={class:"overflow-x-auto"},le={class:"w-full text-sm text-left bg-background text-foreground"},oe={class:"border-b"},ce=["onClick"],ie={class:"px-1 py-3"},de={class:"px-1 py-3"},ue={class:"px-1 py-3"},pe={class:"flex flex-col items-center gap-1"},fe={class:"inline-flex items-center gap-1"},_e={class:"px-1 py-3"},me={key:0},he={key:1},xe={class:"px-1 py-3"},ke={class:"inline-flex items-center gap-1"},ve={key:2},ye={key:0,class:"px-4 py-3"},ge={class:"flex flex-col items-center gap-1"},be={class:"inline-flex items-center gap-1"},Se={key:0,class:"inline-flex items-center gap-1"},we={key:1,class:"px-4 py-3"},ze={__name:"StudentsView",setup(g){const{getStudents:i}=W(),F=R();let z="ltr";const f=x(null),m=x(null),V=X(),D=V.query.semester,I=V.query.class,A=[{title:"Semesters List",link:"/"},{title:"Classes List",link:`/classes?semester=${D}`},{title:"Students List",link:""}],b=x([]),N=x([]);T(async()=>{const{studentsData:o,direction:c}=await i(D,I),a=o.flatMap(n=>n.dates.map(l=>l.date)),e=[...new Set(a)].map((n,l)=>({label:n,field:`session${l+1}`,sortable:!1}));b.value=o.map((n,l)=>{var p;return{number:l+1,fullName:n.fullName,records:(p=n.dates)==null?void 0:p.map(h=>h.records),presentation:{presented:n.presentation.presented,date:n.presentation.date,title:n.presentation.title},finalScore:n.finalScore,totalScore:{passed:n.totalScore.passed,score:n.totalScore.score}}}),N.value=[{label:"#",field:"number",sortable:!0},{label:"نام و نام خانوادگی",field:"fullName",sortable:!0},{label:"ارائه",field:"presentation",sortable:!0},{label:"پایان ترم",field:"finalScore",sortable:!0},{label:"نمره کل",field:"totalScore",sortable:!0},...e],z=c});const j=L(()=>f.value?[...b.value].sort((o,c)=>{var l,p,h,B;let a,e;switch(f.value){case"presentation":a=((l=o.presentation)==null?void 0:l.presented)||!1,e=((p=c.presentation)==null?void 0:p.presented)||!1;break;case"finalScore":a=o.finalScore||0,e=c.finalScore||0;break;case"totalScore":a=((h=o.totalScore)==null?void 0:h.score)||0,e=((B=c.totalScore)==null?void 0:B.score)||0;break;default:a=o[f.value],e=c[f.value];break}if(a===e)return 0;const n=m.value==="asc"?1:-1;return a>e?n:-n}):b.value),S=L(()=>{const o=F.searchValue.toLowerCase(),c=a=>Array.isArray(a)?a.map(c).join(" "):a&&typeof a=="object"?Object.values(a).map(c).join(" "):String(a||"").toLowerCase();return j.value.filter(a=>c(a).includes(o))}),E=o=>{f.value===o?m.value=m.value==="asc"?"desc":"asc":(f.value=o,m.value="asc")};return(o,c)=>{var a;return t(),r("main",null,[M(O,{"breadcrumb-items":A}),s("div",ae,[((a=S.value)==null?void 0:a.length)>0?(t(),r("div",{key:0,dir:U(z),class:"overflow-hidden rounded-md border"},[s("div",re,[s("table",le,[s("thead",oe,[s("tr",null,[(t(!0),r(k,null,w(N.value,e=>(t(),r("th",{key:e.field,class:"px-4 py-2 font-medium text-center"},[s("div",{class:q(["flex items-center justify-center gap-2 rounded text-center ps-2 pe-1.5 py-2 transition-colors duration-300 w-max mx-auto whitespace-nowrap","text-muted-foreground ",{"hover:text-inherit hover:bg-secondary cursor-pointer":e.sortable}]),onClick:n=>e.sortable?E(e.field):null},[v(u(e.label)+" ",1),e.sortable?(t(),d(se,{key:0,class:"size-5"})):y("",!0)],10,ce)]))),128))])]),s("tbody",null,[(t(!0),r(k,null,w(S.value,(e,n)=>(t(),r("tr",{key:n,class:q(["whitespace-nowrap text-center",{"border-b":n!==S.value.length-1}])},[s("td",ie,u(e.number),1),s("td",de,u(e.fullName),1),s("td",ue,[s("div",pe,[s("span",null,u(e.presentation.date),1),s("span",fe,[e.presentation.presented===!0?(t(),d(_,{key:0,class:"size-7 text-green-500"})):e.presentation.presented===!1?(t(),d($,{key:1,class:"size-6 text-red-500"})):(t(),d(_,{key:2,class:"size-7 text-amber-500"})),v(" "+u(e.presentation.title),1)])])]),s("td",_e,[e.finalScore?(t(),r("span",me,u(e.finalScore),1)):(t(),r("span",he,"-"))]),s("td",xe,[s("div",ke,[e.totalScore.passed===!0?(t(),d(_,{key:0,class:"size-7 text-green-500"})):e.totalScore.passed===!1?(t(),d($,{key:1,class:"size-6 text-red-500"})):y("",!0),s("span",null,u(e.totalScore.score),1),!e.totalScore.score&&!e.totalScore.passed?(t(),r("span",ve,"-")):y("",!0)])]),(t(!0),r(k,null,w(e.records,(l,p)=>(t(),r(k,{key:"record"+p},[l?(t(),r("td",ye,[s("div",ge,[s("span",be,[l.attendance?(t(),d(_,{key:0,class:"size-7 text-green-500"})):(t(),d($,{key:1,class:"size-6 text-red-500"})),v(" "+u(l.attendance?"حاضر":"غایب"),1)]),l.homeWork?(t(),r("span",Se,[M(_,{class:"size-7 text-green-500"}),c[0]||(c[0]=v(" تمرین ارسال شده "))])):y("",!0),s("span",null,u(l.quiz),1)])])):(t(),r("td",we,"-"))],64))),128))],2))),128))])])])],8,ne)):(t(),d(G,{key:1}))])])}}};export{ze as default};
